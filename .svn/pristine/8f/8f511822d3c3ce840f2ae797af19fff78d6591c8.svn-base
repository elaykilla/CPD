#{extends 'main.html' /}
#{set title:'Résultats de recherche' /}
#{subtitleTag as:'Recherche CPD' /}
<div class="offset2 container-fluid">
    <div class="row-fluid">    
        <div class="span9">
            <h2 id="pCenter">Résultats de recherche</h2>
            <div class="row-fluid blog-page blog-item">
                #{pagination page:(page < 1 ? 1:page), size:size, nbPages:nbPages, nbPagesMax:nbPagesMax /}
                #{if (users?.size() > 0)}
                <h2>Les membres</h2>
                #{list items:users, as:'user'}
                <div class="posts margin-bottom-20">
                    <dl class="dl-horizontal">
                        <dt><a href="@{Users.user(user?.id)}">
                            <img #{if user?.photo == null}  
                                src="@{'/public/images/election.jpg'}" #{/if} 
                                #{else} src="${user?.profileUrl()}" #{/else} alt="Mon image" alt="" />
                        </a>
                        <dd>
                            <a id="themecolor" href="@{Users.user(user?.id)}">${user?.fullName()}</a>
                            <hr style="margin-bottom: 0px;"/>
                            <span>${user?.dendrite?.named}</span> <span> ${user?.promotion} </span><br/>
                            <span>${user?.cv?.resume}</span>
                        </dd>
                    </dl>
                </div>
                #{/list}
                #{/if}
                #{if (articles?.size() > 0)}
                <h2>Les articles</h2>
                #{listArticlesTag articles:articles, connected:connected /}
                #{/if}
                #{if (events?.size() > 0)}
                <h2>Evènements</h2>
                #{eventsTag events:events, as:'dendrite'/}
                #{/if}
                #{if (announces?.size() > 0)}
                <h2>Annonces</h2>
                #{announcesTag announces:announces, as:'dendrite' /}
                #{/if}
                #{pagination page:(page < 1 ? 1:page), size:size, nbPages:nbPages, nbPagesMax:nbPagesMax /}
            </div>
        </div>

        <div class="span3">
            <!-- Search Bar -->
            <form action="@{Articles.search}" method="post">
                <div class="headline"><h3>Trouver quelque chose</h3></div>
                <div class="input-append  margin-bottom-20">
                    <input type="text" class="span9" name="q">
                    <input type="hidden" class="span9" name="page" value="${page}">
                    <button type="submit" class="btn-u">Search</button>
                </div>
            </form><!-- /Search Bar -->

            <!-- Posts -->
            <div class="posts margin-bottom-20">
                #{if recents?.size()}
                <div class="headline"><h3>Les articles récents</h3></div>
                #{list items:recents, as:'a'}
                <dl class="dl-horizontal">
                    <dt><a href="@{Users.user(a?.author.id)}"><img src="${a?.author?.smallUrl()}" alt="" /></a></dt>
                    #{if (a.myType() == 'article')}
                    <dd>
                        <a href="@{Articles.article(a?.id)}"><div class="zoneTexte">${a?.title}</div></a>
                    </dd>
                    #{/if}
                    #{if (a.myType() == 'event')}
                    <dd>
                        <a href="@{Events.event(a?.id)}"><div class="zoneTexte">${a?.title}</div></a>
                    </dd>
                    #{/if}
                    #{if (a.myType() == 'announce')}
                    <dd>
                        <a href="@{Announces.announce(a?.id)}"><div class="zoneTexte">${a?.title}</div></a>
                    </dd>
                    #{/if}
                </dl>
                #{/list}
                #{/if}
                #{else}
                <p>Aucun article</p>
                #{/else}
            </div><!--/posts-->

        </div>
        <!--/span2-->
    </div>
</div>
